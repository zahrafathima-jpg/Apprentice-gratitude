
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="A personalized daily inspiration generator." />
    <meta property="og:title" content="Food for Thought" />
    <meta property="og:site_name" content="Food for Thought" />
    <title>Food for Thought</title>
    
    <!-- Styles & Fonts -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <!-- React & ReactDOM (UMD for browser) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX compilation in browser -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
      body {
        font-family: 'Google Sans', sans-serif;
      }
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
      }
      .animate-quote-reveal {
        animation: fadeIn 2s ease-out forwards;
        opacity: 0;
      }
      .animate-fadeIn {
        animation: fadeIn 0.3s ease-out forwards;
      }

      /* Print Styles for A4 Display */
      @media print {
        header, footer, button, .no-print {
          display: none !important;
        }
        body, #root, main {
          background: white !important;
          margin: 0 !important;
          padding: 0 !important;
          height: 100vh !important;
          display: flex;
          align-items: center;
          justify-content: center;
        }
        .print-card {
          box-shadow: none !important;
          border: none !important;
          width: 100% !important;
          max-width: 800px !important;
          transform: scale(1.3);
        }
      }
    </style>
  <script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.30.0"
  }
}
</script>
</head>
  <body class="bg-gray-50 text-gray-900">
    <div id="root"></div>

    <script type="text/babel">
      // --- Constants ---
      const INSPIRATIONAL_QUOTES = [
        "Create the things you wish existed.",
        "Your perspective is your superpower.",
        "Growth is uncomfortable because you've never been here before.",
        "Don't decrease the goal. Increase the effort.",
        "Be the energy you want to attract.",
        "The best way to predict the future is to invent it.",
        "Simplicity is the ultimate sophistication.",
        "Stay hungry. Stay foolish.",
        "Your potential is limited only by your imagination.",
        "Make it happen. Shock everyone."
      ];

      const CoolColors = {
        Teal: '#2dd4bf',   // teal-400
        Indigo: '#6366f1', // indigo-500
        Purple: '#a855f7', // purple-500
      };

      // --- Components ---
      
      const Header = () => {
        return (
          <header className="bg-white border-b border-gray-200 sticky top-0 z-50">
            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
              <div className="flex justify-between items-center h-16">
                <div className="flex items-center gap-2">
                  <div className="flex gap-1.5" aria-hidden="true">
                      <div className="w-2 h-2 sm:w-3 sm:h-3 rounded-full" style={{ backgroundColor: CoolColors.Teal }}></div>
                      <div className="w-2 h-2 sm:w-3 sm:h-3 rounded-full" style={{ backgroundColor: CoolColors.Indigo }}></div>
                      <div className="w-2 h-2 sm:w-3 sm:h-3 rounded-full" style={{ backgroundColor: CoolColors.Purple }}></div>
                  </div>
                  <h1 className="text-lg sm:text-xl font-medium text-gray-700 tracking-tight ml-2">
                    Food for <span className="font-bold text-indigo-600">Thought</span>
                  </h1>
                </div>
                <div className="text-xs sm:text-sm text-gray-500">
                  2025 Edition
                </div>
              </div>
            </div>
          </header>
        );
      };

      const App = () => {
        const [step, setStep] = React.useState('qr');
        const [name, setName] = React.useState('');
        const [currentQuote, setCurrentQuote] = React.useState('');
        const [qrImageUrl, setQrImageUrl] = React.useState('');
        
        // Manual URL edit state
        const [targetUrl, setTargetUrl] = React.useState('');
        const [isEditingUrl, setIsEditingUrl] = React.useState(false);

        React.useEffect(() => {
          // 1. Pick a random quote
          const randomQuote = INSPIRATIONAL_QUOTES[Math.floor(Math.random() * INSPIRATIONAL_QUOTES.length)];
          setCurrentQuote(randomQuote);

          // 2. Initial URL detection
          const baseUrl = window.location.href.split('?')[0];
          setTargetUrl(baseUrl);

          // 3. Check for student mode
          const params = new URLSearchParams(window.location.search);
          if (params.get('s') === '1') {
            setStep('input');
          }
        }, []);

        // Regenerate QR when targetUrl changes
        React.useEffect(() => {
          if (!targetUrl) return;
          const cleanBase = targetUrl.split('?')[0];
          const studentUrl = `${cleanBase}?s=1`;
          const encodedUrl = encodeURIComponent(studentUrl);
          setQrImageUrl(`https://quickchart.io/qr?text=${encodedUrl}&size=500&ecLevel=L&dark=000000&light=ffffff&margin=4`);
        }, [targetUrl]);

        // --- Audio Logic ---
        const playAudio = (type) => {
          try {
            const AudioContext = window.AudioContext || window.webkitAudioContext;
            if (!AudioContext) return;
            
            const ctx = new AudioContext();
            const now = ctx.currentTime;

            if (type === 'click') {
              const osc = ctx.createOscillator();
              const gain = ctx.createGain();
              osc.connect(gain);
              gain.connect(ctx.destination);
              osc.type = 'sine';
              osc.frequency.setValueAtTime(800, now);
              osc.frequency.exponentialRampToValueAtTime(400, now + 0.08);
              gain.gain.setValueAtTime(0.05, now);
              gain.gain.exponentialRampToValueAtTime(0.01, now + 0.08);
              osc.start(now);
              osc.stop(now + 0.08);
            } else if (type === 'success') {
              const notes = [523.25, 659.25, 783.99, 987.77]; 
              notes.forEach((freq, i) => {
                const osc = ctx.createOscillator();
                const gain = ctx.createGain();
                osc.connect(gain);
                gain.connect(ctx.destination);
                osc.type = 'triangle'; 
                osc.frequency.value = freq;
                const startTime = now + (i * 0.05);
                gain.gain.setValueAtTime(0, startTime);
                gain.gain.linearRampToValueAtTime(0.05, startTime + 0.05);
                gain.gain.exponentialRampToValueAtTime(0.001, startTime + 2.0);
                osc.start(startTime);
                osc.stop(startTime + 2.0);
              });
            }
          } catch (e) {
            console.error("Audio play failed", e);
          }
        };

        const handleUnlock = (e) => {
          e.preventDefault();
          if (!name.trim()) return;

          playAudio('success');
          triggerConfetti();
          setStep('result');
        };

        const triggerConfetti = () => {
          if (window.confetti) {
            const duration = 3000;
            const animationEnd = Date.now() + duration;
            const defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };
            const randomInRange = (min, max) => Math.random() * (max - min) + min;

            const interval = setInterval(function() {
              const timeLeft = animationEnd - Date.now();
              if (timeLeft <= 0) return clearInterval(interval);
              const particleCount = 50 * (timeLeft / duration);
              
              const confettiColors = ['#6366f1', '#06b6d4', '#a855f7'];

              window.confetti(Object.assign({}, defaults, { 
                particleCount, 
                colors: confettiColors,
                origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 } 
              }));
              window.confetti(Object.assign({}, defaults, { 
                particleCount, 
                colors: confettiColors,
                origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 } 
              }));
            }, 250);
          }
        };

        return (
          <div className="min-h-screen bg-gray-50 flex flex-col font-sans text-gray-900">
            <Header />

            <main className="flex-grow flex flex-col items-center justify-center p-4">
              
              {/* STEP 1: QR CODE */}
              {step === 'qr' && (
                <div className="print-card bg-white p-8 rounded-3xl shadow-xl max-w-lg w-full text-center border border-gray-100">
                  <h2 className="text-3xl font-bold text-gray-800 mb-2">Ready for some inspiration?</h2>
                  <p className="text-gray-600 mb-8">Scan to unlock your daily insight.</p>
                  
                  <div className="bg-white p-2 rounded-xl border-2 border-gray-100 inline-block mb-6 shadow-sm">
                    <img 
                      src={qrImageUrl} 
                      alt="QR Code to scan and open this app on mobile" 
                      className="w-64 h-64 sm:w-80 sm:h-80 object-contain mx-auto"
                    />
                  </div>

                  {/* URL Editor */}
                  <div className="no-print mb-8">
                    {isEditingUrl ? (
                      <div className="flex flex-col gap-2 animate-fadeIn">
                        <label className="text-xs font-bold text-gray-500 uppercase">Set Public URL</label>
                        <div className="flex gap-2 justify-center">
                          <input 
                            type="text" 
                            value={targetUrl}
                            onChange={(e) => setTargetUrl(e.target.value)}
                            className="border border-gray-300 rounded-lg px-3 py-1 text-sm w-full max-w-xs focus:ring-2 focus:ring-indigo-500 outline-none"
                            placeholder="https://your-app.vercel.app"
                          />
                          <button 
                            onClick={() => setIsEditingUrl(false)}
                            className="bg-indigo-600 text-white px-3 py-1 rounded-lg text-sm font-medium hover:bg-indigo-700"
                          >
                            Save
                          </button>
                        </div>
                      </div>
                    ) : (
                      <div className="flex flex-col items-center gap-1 group">
                         <p className="text-xs text-gray-400">QR points to: <span className="font-mono">{targetUrl}</span></p>
                         <button 
                          onClick={() => setIsEditingUrl(true)}
                          className="text-xs text-indigo-500 font-medium hover:underline hover:text-indigo-600 flex items-center gap-1"
                         >
                           <svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" /></svg>
                           Edit Link (Fix for Private Previews)
                         </button>
                      </div>
                    )}
                  </div>

                  <div className="no-print space-y-4">
                    <div className="flex flex-col sm:flex-row gap-4 justify-center">
                      <button 
                        onClick={() => {
                          playAudio('click');
                          setStep('input');
                        }}
                        className="px-6 py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-medium rounded-full transition-colors focus:ring-4 focus:ring-indigo-200 focus:outline-none shadow-md hover:shadow-lg"
                      >
                        Start Manual
                      </button>
                    </div>
                  </div>
                </div>
              )}

              {/* STEP 2: NAME INPUT */}
              {step === 'input' && (
                <div className="bg-white p-8 sm:p-12 rounded-3xl shadow-xl max-w-md w-full text-center border border-gray-100">
                   <div className="mb-6 flex justify-center" aria-hidden="true">
                     <span className="text-4xl">ðŸ‘‹</span>
                   </div>
                   <h2 className="text-2xl font-bold text-gray-800 mb-2">Let's get started.</h2>
                   
                   <form onSubmit={handleUnlock} className="space-y-6">
                     <label htmlFor="name-input" className="block text-gray-500 mb-8 text-sm">
                        Enter your name to unlock your quote.
                     </label>

                     <input 
                       id="name-input"
                       name="name"
                       autoComplete="given-name"
                       type="text" 
                       value={name}
                       onChange={(e) => setName(e.target.value)}
                       onFocus={() => playAudio('click')}
                       placeholder="Your Name"
                       className="w-full text-center text-xl p-4 border-2 border-gray-200 rounded-xl focus:border-indigo-500 focus:ring-4 focus:ring-indigo-50 focus:ring-offset-2 focus:outline-none transition-all duration-300 focus:scale-[1.02] focus:shadow-lg placeholder-gray-400 text-gray-900"
                       autoFocus
                     />
                     <button 
                       type="submit"
                       disabled={!name.trim()}
                       aria-label="Unlock my personalized message"
                       className={`
                         w-full py-4 rounded-xl text-lg font-bold text-white transition-all duration-300 transform focus:outline-none focus:ring-4 focus:ring-offset-2
                         ${name.trim() 
                           ? 'bg-indigo-600 hover:bg-indigo-700 shadow-lg hover:shadow-xl hover:-translate-y-1 scale-100 focus:ring-indigo-500' 
                           : 'bg-gray-300 cursor-not-allowed scale-[0.98]'
                         }
                       `}
                     >
                       Unlock Message
                     </button>
                   </form>
                </div>
              )}

              {/* STEP 3: RESULT */}
              {step === 'result' && (
                <div 
                  className="bg-white p-8 sm:p-12 rounded-3xl shadow-xl max-w-lg w-full text-center border-t-8 border-indigo-500 relative overflow-hidden animate-quote-reveal"
                  aria-live="polite"
                >
                  
                  {/* Background decorations */}
                  <div className="absolute top-0 right-0 -mr-8 -mt-8 w-32 h-32 rounded-full bg-purple-100 opacity-50 blur-xl" aria-hidden="true"></div>
                  <div className="absolute bottom-0 left-0 -ml-8 -mb-8 w-32 h-32 rounded-full bg-teal-100 opacity-50 blur-xl" aria-hidden="true"></div>

                  <div className="relative z-10">
                    <h2 className="text-3xl sm:text-4xl font-bold text-gray-800 mb-6">
                      Hello, <span className="text-indigo-600">{name}</span>!
                    </h2>
                    
                    <div className="my-8">
                       <div className="inline-block p-4 rounded-full bg-gray-50 mb-6" aria-hidden="true">
                          <span className="text-4xl">âœ¨</span>
                       </div>
                       <blockquote className="text-xl sm:text-2xl font-medium text-gray-700 leading-relaxed font-google-sans italic">
                         "{currentQuote}"
                       </blockquote>
                    </div>

                    <div className="mt-8 pt-8 border-t border-gray-100">
                      <p className="text-sm font-bold text-gray-400 uppercase tracking-widest">
                        Food for Thought 2025
                      </p>
                    </div>
                  </div>
                </div>
              )}

            </main>
            
            <footer className="p-6 text-center text-gray-500 text-xs no-print">
              <p>Â© 2025 Food for Thought Studio</p>
            </footer>
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
  </body>
</html>
